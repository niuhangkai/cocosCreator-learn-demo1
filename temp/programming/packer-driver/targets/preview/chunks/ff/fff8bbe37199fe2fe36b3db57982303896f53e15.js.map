{"version":3,"sources":["file:///Users/mac20211105/Desktop/cocosCreator-demo-learn/AircraftWars/assets/Scripts/Player.ts"],"names":["Prefab","instantiate","_decorator","Component","Node","Vec3","ccclass","property","ShootType","Player","shootTimer","onLoad","node","on","EventType","TOUCH_MOVE","onTouchMove","update","deltaTime","shootType","Single","singleShoot","Double","doubleShoot","Triple","frequency","bullet1","bulletPrefab","bulletParent","addChild","console","log","bulletInitPos","worldPosition","setWorldPosition","bulletPrefab2","bullet2","bulletInitPos2","bulletInitPos3","event","p","position","targetPos","x","getDeltaX","y","getDeltaY","z","setPosition"],"mappings":"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","sourcesContent":["import {Prefab, instantiate, _decorator, Component, Node, EventTouch, Vec3 } from 'cc';\nconst { ccclass, property } = _decorator;\n\nenum ShootType {\n    Single = 0,\n    Double = 1,\n    Triple = 2,\n}\n@ccclass('Player')\nexport class Player extends Component {\n    // 子弹部分\n    @property\n    // 发射频率，0.5秒发射一次\n    frequency: number = 0.5;\n\n    // 射击计时器\n    shootTimer: number = 0;\n\n    // 获取到子弹预制体，这里需要在编辑中，拖拽预制体到这个属性，并且在下面update中实例化\n    @property(Prefab)\n    bulletPrefab: Prefab = null;\n\n    // 子弹的父节点，子弹会添加到这个节点下\n    @property(Node)\n    bulletParent: Node = null;\n\n    // 子弹的初始位置\n    @property(Node)\n    bulletInitPos: Node = null;\n    \n    // 射击类型\n    @property(ShootType)\n    shootType: ShootType = ShootType.Single;\n\n    // 第二种子弹的prefab\n    @property(Prefab)\n    bulletPrefab2: Prefab = null;\n\n    // 第二种两个子弹的初始位置\n    @property(Node)\n    bulletInitPos2: Node = null;\n    @property(Node)\n    bulletInitPos3: Node = null;\n\n\n\n\n    // 绑定touchmove事件\n    // onLoad 是 cocos 的钩子函数，在节点加载时调用\n    protected onLoad(): void {\n        this.node.on(Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\n    }\n    protected update(deltaTime: number): void {\n\n        switch(this.shootType) {\n            case ShootType.Single: // 0\n                this.singleShoot(deltaTime);\n                break;\n            case ShootType.Double: // 1\n                this.doubleShoot(deltaTime);\n                break;\n            case ShootType.Triple: // 2\n                this.singleShoot(deltaTime);\n                this.doubleShoot(deltaTime);\n                break;\n        }\n\n\n    }\n    // 单发射击\n    singleShoot(deltaTime: number): void {\n        // deltaTime 是时间间隔,每帧调用一次,每次时间间隔大概0.016秒\n        this.shootTimer += deltaTime;\n        // 如果shootTime大于等于frequency，则发射子弹\n        if (this.shootTimer >= this.frequency) {\n            // 计时器清零\n            this.shootTimer = 0;\n            // 实例化子弹\n            // instantiate 是 cocos 的实例化函数\n            const bullet1 = instantiate(this.bulletPrefab);\n            // 添加到场景中\n            this.bulletParent.addChild(bullet1);\n            console.log(this.bulletParent, 'this.bulletParent',this.bulletInitPos.worldPosition, 'this.bulletInitPos')\n            // 设置子弹位置\n            bullet1.setWorldPosition(this.bulletInitPos.worldPosition);\n        }\n    }\n    // 双发射击\n    doubleShoot(deltaTime: number): void {\n         // deltaTime 是时间间隔,每帧调用一次,每次时间间隔大概0.016秒\n         this.shootTimer += deltaTime;\n         // 如果shootTime大于等于frequency，则发射子弹\n         if (this.shootTimer >= this.frequency) {\n             // 计时器清零\n             this.shootTimer = 0;\n             // 实例化子弹\n             // instantiate 是 cocos 的实例化函数\n             const bullet1 = instantiate(this.bulletPrefab2);\n             const bullet2 = instantiate(this.bulletPrefab2);\n             // 添加到场景中\n             this.bulletParent.addChild(bullet1);\n             this.bulletParent.addChild(bullet2);\n\n             // 设置子弹位置\n             bullet1.setWorldPosition(this.bulletInitPos2.worldPosition);\n             bullet2.setWorldPosition(this.bulletInitPos3.worldPosition);\n         }\n    }\n\n    // 触摸移动事件\n    onTouchMove(event: EventTouch): void {\n        console.log('触摸移动事件');\n        // 跟随鼠标移动\n        const p = this.node.position\n        // Vec3 是 cocos 的向量类\n        let targetPos = new Vec3(p.x + event.getDeltaX(), p.y + event.getDeltaY(),p.z);\n        // 限制移动范围\n\n        if (targetPos.x <= -234) {\n            targetPos.x = -234;\n        }\n\n        if (targetPos.x >= 234) {\n            targetPos.x = 234;\n        }\n\n        if (targetPos.y <= -400) {\n            targetPos.y = -400;\n        }\n\n        if (targetPos.y >= 400) {\n            targetPos.y = 400;\n        }\n\n        this.node.setPosition(targetPos);\n    }\n}\n\n"]}